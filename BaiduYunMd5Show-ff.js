// ==UserScript==
// @name        BaiduYunMd5Show
// @namespace   asahui
// @description Show the md5 of files in the baidu pan
// @include     http://pan.baidu.com/disk/home*
// @run-at      document-start
// @version     0.1
// @grant       none
// ==/UserScript==
window.addEventListener('afterscriptexecute', function (e) {
    var src = e.target.src;
    if (src.search(/speed-disk-home_9831c91\.js/) > 0) {
        define("clouddisk-ui:widget/list-view/disk-home.js",function(e,t,i){var a=e("common:widget/commonService/commonService.js"),s=e("common:widget/fileDelete/fileDelete.js"),n=e("common:widget/fileManagerApi/fileManagerApi.js"),o=e("common:widget/restApi/restApi.js"),r=e("common:widget/hash/hash.js"),l=e("common:widget/toast/toast.js"),c=(e("common:widget/context/context.js"),e("common:widget/libs/jquerypacket.js")),d=e("common:widget/thirdPartManage/thirdPartManage.js"),g=e("common:widget/data-center/data-center.js"),m={},u=536e3,f=function(e){if(h.list.cash){for(var t,i=0;i<h.list.cash.length&&(t=h.list.cash[i],t.fs_id.toString()!==e.toString());i++);return t}},p=function(e){var t=0;for(getItem=[],t;t<e.length;t++)getItem.push(f(e[t]));return getItem};g.set("tmpl-selected-list",function(){var e=g.get("selectedList");return p(e)});var h={};h.list={cash:{},params:{num:100,page:1,dir:"/",order:"time",desc:1,showempty:0},cxt:{},renderCallback:null,lastPage:-1,isMore:!0,isBusy:!1},g.get("isIE6")&&(h.list.params.num=30),h.list.cxt={mListView:{width:{name:"60%",cols:["7%","10%","22%"]},title:{name:"文件名",cols:["大小","修改日期","MD5"]},titleKey:{name:"name",cols:["size","time","md5"]},isAppend:!1,list:[]}},h.list.cxtSearch={mListView:{width:{name:"60%",cols:["16%","13%","10%"]},title:{name:"文件名",cols:["大小","修改日期","所在目录"]},titleKey:{name:"name",cols:["size","time","path-info"]},isAppend:!1,list:[]}},h.list.formatListData=function(e){var t,i,s,n=[],o={};for(o.list=e,t=0;t<o.list.length;t++){i=o.list[t],s={},s.id=i.fs_id,s.name=i.server_filename,s.category=i.category,s.cols=[a.toFriendlyFileSize(i.size),a.parseDate(i.server_mtime),i.md5],i.isdir&&(s.cols[0]="-"),i.path.match(/^\/apps$/)&&(s.name="我的应用数据"),i.thumbs&&i.thumbs.url1&&(s.thumb=i.thumbs.url1);var r,l,c=i.path.split("/");2===c.length?(r="/",l="全部文件"):(r=c.slice(0,c.length-1).join("/"),l=c[c.length-2]),h.list.params.key&&s.cols.push('<span class="search-feild" node-type="search-feild" data-path="'+r+'" title="'+l+'">'+l+"</span>"),s.extName=a.getFileExtName(i.path,i.isdir),s.btns=["share","download","more"],s.openEnabled=a.isOpenedFile(s.extName),s.openEnabled||(s.openEnabled=d.isOpenFile(s.extName)),n.push(s)}return n},h.list.formatCategoryData=function(e){var t,i,s,n=[],o={};for(o.info=e,t=0;t<o.info.length;t++)i=o.info[t],s={},s.id=i.fs_id,s.name=i.server_filename,s.category=i.category,s.cols=[a.toFriendlyFileSize(i.size),a.parseDate(i.server_mtime)],i.isdir&&(s.cols[0]="-"),i.thumbs&&i.thumbs.url1&&(s.thumb=i.thumbs.url1),s.extName=a.getFileExtName(i.path,i.isdir),s.btns=["share","download","more"],s.openEnabled=a.isOpenedFile(s.extName),s.openEnabled||(s.openEnabled=d.isOpenFile(s.extName)),n.push(s);return n},h.list.lastRenderType=r.get("render-type"),h.list.lastKey=r.get("key"),h.list.lastPath=r.get("path"),h.list.lastCategory=r.get("category/type"),h.list.lastRenderType&&""!==h.list.lastRenderType||(h.list.lastRenderType="list-view"),h.listenHash=function(){var e;r.listen("key, path, category/type, render-type",function(){window.clearTimeout(e),e=window.setTimeout(function(){var e=r.get("render-type"),t=r.get("key"),i=r.get("path"),a=r.get("category/type");a===h.list.lastCategory&&t===h.list.lastKey&&i===h.list.lastPath&&e!==h.list.lastRenderType?g.set("isOnlyRenderTypeChange",!0):g.set("isOnlyRenderTypeChange",!1),h.list.params.page=1,v.render(h.list.renderCallback),h.list.lastRenderType=e,h.list.lastKey=t,h.list.lastPath=i,h.list.lastCategory=a},100)})};var y=!1,v={myfun:function(){},orderKey:"time",isDesc:!0,loading:function(){},setListRenderHandler:function(e){"function"==typeof e&&(h.list.renderCallback=function(){e.apply(void 0,arguments),y||(mdev.message.trigger("after-list-loaded"),y=!0)})},setListLoadingHandler:function(){},sort:function(e,t){h.list.params.order=e,t?h.list.params.desc=1:delete h.list.params.desc,h.list.params.page=1,h.list.isSorting=!0,this.render(h.list.renderCallback)},renderTitle:function(e){var t=h.list.cxt;h.list.params.key&&(t=h.list.cxtSearch),h.list.renderTitleCallback=h.list.renderTitleCallback||e,h.list.renderTitleCallback&&h.list.renderTitleCallback(t)},render:function(t){var i=this,a=h.list.cxt,s=h.list.params,n=r.get("category/type"),o=r.get("path"),l=r.get("key");s.category=n,s.dir=o,s.key=l,s.dir&&""!==s.dir?(delete s.category,delete s.key):s.key?(delete s.category,s.dir="",a=h.list.cxtSearch):s.category&&""!==s.category?(delete s.key,s.dir="/","time2"===s.order&&(s.order="time"),"2"===s.category?(s.category="3",g.get("is-timeline")&&r.set("render-type","grid-view"),"time"===s.order,"function"==typeof t&&(h.list.renderCallback=t)):"3"===s.category&&(s.category="2")):(delete s.category,delete s.key,s.dir="/"),v.renderTitle(),this.orderKey=s.order,this.isDesc=s.desc,"time2"===this.orderKey&&(this.orderKey="time"),g.set("orderKey",s.order),g.set("isDesc",s.desc);var c=!1;1!==s.page?c=!0:(h.list.isMore=!0,h.list.isSorting?h.list.isSorting=!1:this.loading(!0)),mdev.message.trigger("render-crumbs-count",-1);var d=e("common:widget/api-center/api-center.js");s.category?(s.desc||(s.desc=0),d.getFileListByCategoryAsyc(s,function(e){return!e.info.length&&s.page>1?(mdev.message.trigger("render-crumbs-count",h.list.cash.length,!0),void(h.list.isMore=!1)):(e.info.length<s.num&&(h.list.isMore=!1),h.list.cash=c?h.list.cash.concat(e.info):e.info,a.mListView.list=h.list.formatCategoryData(e.info),h.list.renderCallback(a,c),mdev.message.trigger("render-crumbs",s.dir),mdev.message.trigger("render-crumbs-count",h.list.cash.length,e.info.length<s.num),void i.loading(!1))})):s.key?d.searchFileListAsyc(s,function(e){return!e.list.length&&s.page>1?(h.list.isMore=!1,void mdev.message.trigger("render-crumbs-count",h.list.cash.length,!0)):(e.list.length<s.num&&(h.list.isMore=!1),h.list.cash=c?h.list.cash.concat(e.list):e.list,a.mListView.list=h.list.formatListData(e.list),h.list.renderCallback(a,c),mdev.message.trigger("render-crumbs","search-"+s.key),mdev.message.trigger("render-crumbs-count",h.list.cash.length,e.list.length<s.num),void i.loading(!1))}):d.getFileListAsyc(s,function(e){return!e.list.length&&s.page>1?(h.list.isMore=!1,void mdev.message.trigger("render-crumbs-count",h.list.cash.length,!0)):(e.list.length<s.num&&(h.list.isMore=!1),h.list.cash=c?h.list.cash.concat(e.list):e.list,a.mListView.list=h.list.formatListData(e.list),h.list.renderCallback(a,c),mdev.message.trigger("render-crumbs",s.dir),mdev.message.trigger("render-crumbs-count",h.list.cash.length,e.list.length<s.num),void i.loading(!1))})},loadMore:function(){h.list.isMore&&(h.list.params.page++,this.render(h.list.renderCallback))},share:function(e){var t=p(e);a.getWidgets("common:widget/shareDialog/shareDialog.js",function(){mdev.message.trigger("share",{list:t})})},download:function(e){var t=p(e);a.getWidgets("common:widget/downloadProxyPcs/downloadProxyPcs.js",function(){mdev.message.trigger("download",{list:t})})},move:function(e,t){var i=p(e);a.getWidgets("common:widget/fileMoveCopyManager/fileMoveCopyManager.js",function(e){m.fileMoveCopyManager=m.fileMoveCopyManager||new e,m.fileMoveCopyManager.reBuild({list:i,filemanager:"move",succCallback:function(e,i){t(e,i)},failCallback:function(){}})})},moveTo:function(e,t,i){var s=p(e),n=f(t);if(n.isdir){var o=n.path;a.getWidgets("common:widget/fileMoveCopyManager/fileMoveCopyManager.js",function(e){m.fileMoveCopyManager=m.fileMoveCopyManager||new e,m.fileMoveCopyManager.moveTo({list:s,filemanager:"move",succCallback:function(e,t){i(e,t)},destPath:o})})}},copy:function(e){var t=p(e);a.getWidgets("common:widget/fileMoveCopyManager/fileMoveCopyManager.js",function(e){m.fileMoveCopyManager=m.fileMoveCopyManager||new e,m.fileMoveCopyManager.reBuild({list:t,filemanager:"copy",succCallback:function(){},failCallback:function(){}})})},rename:function(e,t,i){var s=f(e);a.getWidgets("common:widget/fileReName/fileReName.js",function(e){m.fileReName=m.fileReName||e.obtain,m.fileReName.sendUpdateFileMessage(s.isdir,s.path,t,function(){var e=s.path.split("/");e[e.length-1]=t,s.path=e.join("/"),s.server_filename=t,i()})})},print:function(e){var t=p(e);a.getWidgets("common:widget/fileCloudPrint/fileCloudPrint.js",function(e){e.obtain.reBuild({list:t})})},history:function(e){var t=p(e);a.getWidgets("common:widget/fileVersionHistory/fileVersionHistory.js",function(e){m.fileVersionHistory=new e,m.fileVersionHistory.reBuild({desc:1,list:t,isVip:!0})})},del:function(e,t){var i=p(e);s.obtain.done({fileList:i,succCallback:t})},imagePre:function(e){var t=p(e),i=[],s=[];a.getWidgets("common:widget/picPreview/picPreview.js",function(){var e,a=0,n=0,o=0;for(e=h.list.cash.length;e>a;a++){var r=h.list.cash[a];"3"==r.category&&(i.push(r),r==t[0]?o=n:n++)}mdev.message.trigger("show_picture",{index:o,list:i}),mdev.message.listen("delete_picPreview",function(e){var t=s.length>0?s:i,a=0;for(s=[],a;a<t.length;a++)a!=e.index&&s.push(i[a]);e.callback(s),v.render(h.list.renderCallback)}),mdev.message.trigger("quota-change"),mdev.message.listen("load_more_pre",function(e){e.callback()}),mdev.message.listen("load_more_next",function(e){e.callback()})})},musicPlay:function(e){var t=f(e),i=[{songId:u++,songName:a.parseDirFromPath(t.path)}],s=function(e){i[0].link=e+"&use=1",a.getWidgets("common:widget/musicBox/musicBox.js",function(e){"undefined"==typeof m.musicBox?m.musicBox=new e(i):m.musicBox.reBuild(i)})};a.getDlink('["'+t.fs_id+'"]',"dlink",function(e){t.dlink=e.dlink[0].dlink,s(a.downloadURL(t))})},musicPlayAll:function(e){var t=p(e),i=[],s=function(e){a.getWidgets("common:widget/musicBox/musicBox.js",function(t){"undefined"==typeof m.musicBox?m.musicBox=new t(e):m.musicBox._mDisplay?(m.musicBox.clearList(),m.musicBox.resetList(e,!0)):(m.musicBox._reInit(),m.musicBox.clearList(),m.musicBox.setVisible(!0),m.musicBox.addMusicData(e,!0))})},n=function(e){for(var i="",n=0,o=t.length;o>n;n++)i+=n===o-1?'"'+t[n].fs_id+'"':'"'+t[n].fs_id+'",';i="["+i+"]",a.getDlink(i,"dlink",function(i){var n=i.dlink;if(n.length>=1)for(var o=0,r=n.length;r>o;o++)t[o].dlink=n[o].dlink,e[o].link=a.downloadURL(t[o])+"&use=1";else 0===n.length&&(e.dlink=a.downloadURL(n));s(e)})};if(0==t.length)return l.obtain.useToast({toastMode:l.obtain.MODE_CAUTION,msg:"当前列表为空，请添加音乐文件",sticky:!1}),!1;for(var o=0,r=t.length;r>o;o++)i.push({songId:u++,songName:a.parseDirFromPath(t[o].path),link:a.downloadURL(t[o])});n(i)},playVedio:function(t){var i=f(t),a=e("common:widget/filePlayVedio/filePlayVedio.js");m.filePlayVedio=m.filePlayVedio||a.obtain,m.filePlayVedio.reBuild(i)},otherFile:function(e){var t=f(e);return subffix=a.getFileExtName(t.server_filename),"dws"==subffix||"dwt"==subffix||"dxf"==subffix||"dwg"==subffix?void this.openCad(e):"zip"==subffix||"rar"==subffix?void this.unZip(e):void d.openThird(subffix,t)},openCad:function(e){var t=f(e);t.path&&window.open("http://pan.baidu.com/disk/cadedit?path="+encodeURIComponent(encodeURIComponent(t.path)))},unZip:function(e){var t=f(e);a.getWidgets("common:widget/fileUnzip/fileUnzip.js",function(e){m.fileUnzip=m.fileUnzip||e.obtain({vip:!0}),m.fileUnzip.startResolveUnZip(t.path,t.size,1===parseInt(yunData.ISVIP,10)?!0:!1)})},torrent:function(e){var t=p(e),i=t[0];a.getWidgets("common:widget/resolveBTDialog/resolveBTDialog.js",function(e){m.resolveBTDialog=m.resolveBTDialog||e.obtain(),"function"==typeof m.resolveBTDialog.setTaskFrom&&m.resolveBTDialog.setTaskFrom(e.TASK_FROM_HOMEPAGE),m.resolveBTDialog.resolveBTFile(i.path)})},docReader:function(e){var t=p(e),i=t[0];a.getWidgets("common:widget/docReader/docReader.js",function(e){m.docReader=m.docReader||new e,m.docReader.reBuild(i)})},meitu:function(t){var i=p(t),a=e("common:widget/fileMeitu/fileMeitu.js");m.fileMeitu=m.fileMeitu||new a,m.fileMeitu.build(i)},push:function(t){var i=p(t),a=e("common:widget/devicePushTask/devicePushTask.js");a.obtain.commandPublish({deviceId:g.get("current-push-device"),selectArray:i})},newDir:function(e,t){l.obtain.useToast({toastMode:l.obtain.MODE_LOADING,msg:"正在创建文件夹&hellip;",sticky:!0}),n.sendCreateNewFileApi(e,"",1,null,function(e){0==e.errno&&(h.list.cash.push(e),"function"==typeof t&&t(e),l.obtain.useToast({toastMode:l.obtain.MODE_SUCCESS,msg:"创建文件夹成功",sticky:!1}))},function(e){return l.obtain.useToast({toastMode:l.obtain.MODE_CAUTION,msg:e,sticky:!1}),!1})},nameClick:function(t){var i=f(t),a=e("common:widget/hash/hash.js");if(i.isdir)a.set("path",i.path);else switch(i.category){case 1:this.playVedio([t]);break;case 2:this.musicPlay([t]);break;case 3:this.imagePre([t]);break;case 4:this.docReader([t]);break;case 6:this.otherFile([t]);break;case 7:this.torrent([t])}},folderOpen:function(e){var t=f(e);r.set("path",a.parseFullDirFromPath(t.path)+"/")}},w={showPresentMember:function(){return!window.localStorage||localStorage&&localStorage.getItem("presentMember")?!1:void c.get(o.VIP_USER+"?method=query",function(e){var t=null;try{t=c.parseJSON(e)}catch(i){}if(t&&t.product_infos&&t.product_infos.length>0)for(var s=t.product_infos,n=s.length;n--;)"vip1_3m"===s[n].product_name&&a.getWidgets("common:widget/adTips/presentMembership/presentMembership.js",function(e){e.obtain.setVisible(!0),localStorage&&localStorage.setItem("presentMember",!0)})})},showFeatureManual:function(){return!window.localStorage||localStorage&&localStorage.getItem(yunData.MYNAME+"_vip_wizard_display")||0==yunData.ISVIP?!1:void a.getWidgets("common:widget/adTips/featureManual/featureManual.js",function(e){e.obtain.show(),localStorage&&localStorage.setItem(yunData.MYNAME+"_vip_wizard_display",!0)})},worldTips:function(){return!window.localStorage||localStorage&&localStorage.getItem("world2013_vip")?!1:void c.get("/disk/cmsdata?do=manual&ch=pan_act_tips",function(e){var e=c.parseJSON(e);if(e&&0==e.errorno&&e.content&&0==e.content[0].errno&&"world_2013_2T"==e.content[0].statue)c.get("/activity/query?type=all",function(t){var t=c.parseJSON(t);if(0==t.offlinedl||0==t.volume360)a.getWidgets("common:widget/adTips/worldTips/worldTips.js",function(e){e(),localStorage&&localStorage.setItem("world2013_vip",!0)});else if(!e||0!=e.errorno||!e.content||0!=e.content[2].errno||"homePage_c2c_guide"!=e.content[2].statue)return});else if(!e||0!=e.errorno||!e.content||0!=e.content[2].errno||"homePage_c2c_guide"!=e.content[2].statue)return})}},b=function(){if(h.listenHash(),mdev.message.listen("file-list-render",function(e){e.time2&&(h.list.params.order="time2",h.list.params.desc=1),h.list.params.page=1,v.render(h.list.renderCallback)}),a.sendUserReport(a.compilePingBack()),"undefined"!=typeof window.localStorage)switch(parseInt(10*Math.random()/4)){case 0:w.showPresentMember();break;case 1:w.showFeatureManual();break;case 2:w.worldTips()}window.setTimeout(function(){v.render()},0),mdev.message.listen("after-list-loaded",function(){a.killFrame(),a.testPCSCDNConnectivity(function(e){e&&a.watchCDNOfPCS(e)})}),yunData&&yunData.sampling&&yunData.sampling.indexOf("asynfilemanager_pub")>0&&setTimeout(function(){if(localStorage&&localStorage.getItem){var e,t=localStorage.getItem("asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,""));t&&2===(e=t.split("_")).length&&a.getWidgets("common:widget/asynFileManager/asynFileManager.js",function(t){t.resolveHasTask(e[0],e[1],function(e,t,i,a){1!==e||!a||"move"!==a.operate&&"delete"!==a.operate||refreshPage()})})}},1500)};"disk-home"===g.get("page")&&b(),i.exports=v});
    }
}, true);
